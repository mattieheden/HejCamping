@model HejCamping.Web.Models.BookingViewModel 



@{
    ViewData["Title"] = "Dash Board";
    var bookings = ViewBag.Bookings as List<BookingViewModel>; 
   
}

<h1>@ViewData["Title"]</h1>

@*
@foreach (var booking in ViewBag.Bookings)
{
    <div class="card m-3">
        <h5 class="card-header">@booking.OrderNumber</h5> 
            <div class="card-body">
                <h5 class="card-title">Client name: @booking.Name</h5>
                <h5 class="card-title">Cabin number: @booking.CabinId</h5>
            </div>
    </div>
}
*@


  
<div id='calendar'></div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>

    <script>  
        document.addEventListener('DOMContentLoaded', function() {           
            
            //GetAllBookings();

            var calendarEl = document.getElementById('calendar');       

            var calendar = new FullCalendar.Calendar(calendarEl, {
                
                timeZone: 'UTC',
                //initialView: 'dayGridMonth',                
                headerToolbar: {
                    left: 'prev next today prevYear nextYear',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay,listMonth'
                },
                themeSystem: 'bootstrap5',
                dayMaxEvents: true,
                //showNonCurrentDates: true,
                //weekNumbers: true,
                //editable: true,
                //selectable: true
                //height: 500,
                //aspectRatio: 2,
                contentHeight: 600, 
                
                events: function(fetchInfo, successCallback, failureCallback) {
                    fetch('/AdminPortal/GetAllBookings')
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok' + response.statusText);
                        } else {
                                console.log('Response status is ' + response.statusText);
                        }
                        return response.json();
                    })        
                    .then(data => {
                        
                        //console.log(data);
                       
                        let bookings = data.map(booking => ({
                            title: booking.orderNumber,
                            start: booking.dateStart,
                            end: booking.dateEnd,
                            allDay: true,
                            //display: 'background'
                        }));
                        successCallback(bookings);
                    })
                    .catch(error => {
                        console.log('Error:', error.message);     
                        failureCallback(error);             
                    });          
                }
                
            });     
            calendar.updateSize(),
            calendar.render();
            
            //function GetAllBookings () {}
            
            









        });
    </script> 

}